<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.4</version>
    <template_groups>
        <template_group>
            <uuid>1c527d507234428d993e10d076aa2c21</uuid>
            <name>Manual Templates</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>8bb5d7cd0e794776b84207a05c3441dc</uuid>
            <template>Template SoftEtherVPN server passive v3.0</template>
            <name>Template SoftEtherVPN server passive v3.0</name>
            <description>JSON-RPC based monitoring</description>
            <groups>
                <group>
                    <name>Manual Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>f69692a80cfd4db786345546b695b7ab</uuid>
                    <name>Number of processes vpnserver</name>
                    <key>proc.num[{$VPN_PROC_NAME}]</key>
                    <delay>30s</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <triggers>
                        <trigger>
                            <uuid>10e3a3475b8d44cd8fedb230236c5cd2</uuid>
                            <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                            <name>vpn server stopped on {HOST.NAME}</name>
                            <priority>DISASTER</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>9b0f5d757b264ee5b8cd8b38a49ba6cc</uuid>
                    <name>Sevpn Bridge Stats error message</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[bridge.stats,error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Этот айтем собирает содержимое ключа 'error' в возвращаемом JSON мастер элемента данных.
В шатном режиме он равен пустой строке.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.error</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'error'</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[user.stats]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>a402637dc46449c3afa805a471fddf3d</uuid>
                            <expression>length(last(/Template SoftEtherVPN server passive v3.0/sevpn[bridge.stats,error]))&gt;0</expression>
                            <name>Ошибка при обработке запроса bridge_stats</name>
                            <priority>WARNING</priority>
                            <description>Текст ошибки:  {{ITEM.LASTVALUE}.regsub(&quot;(.*)&quot;, \1)}

Если текст отображается не полностью, то его можно увидеть в мастер элементе данных в поле 'error'.</description>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>cf0baf521cd94c728a6bbb33f615040a</uuid>
                    <name>SoftEtherVPN: Bridge stats JSON</name>
                    <key>sevpn[bridge.stats]</key>
                    <delay>30s</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Получает JSON в котором находится вся вомзожная статистика по пингам внутренних/внешних узлов.</description>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. JSON.</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>40331f3477e441898c32c2fae12324f6</uuid>
                    <name>Sevpn Bridge Support error message</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[bridge.support,error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Этот айтем собирает содержимое ключа 'error' в возвращаемом JSON мастер элемента данных.
В шатном режиме он равен пустой строке.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.error</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'error'</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[user.stats]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>c70dc5d6a1af4957b3d7c8485a8f0f3f</uuid>
                            <expression>length(last(/Template SoftEtherVPN server passive v3.0/sevpn[bridge.support,error]))&gt;0</expression>
                            <name>Ошибка при обработке запроса bridge_support</name>
                            <priority>WARNING</priority>
                            <description>Текст ошибки:  {{ITEM.LASTVALUE}.regsub(&quot;(.*)&quot;, \1)}

Если текст отображается не полностью, то его можно увидеть в мастер элементе данных в поле 'error'.</description>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>5091461808424a84953f75c15b41ca4a</uuid>
                    <name>System Bridge Support by OS</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[bridge.support,os]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['IsBridgeSupportedOs_bool']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[bridge.support]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e61409ca1a564db3b02de6da0c135cca</uuid>
                    <name>WinPCAP needed</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[bridge.support,winpcap]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['IsWinPcapNeeded_bool']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[bridge.support]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a59a25b0848446449183d7e0fa83a8af</uuid>
                    <name>SoftEtherVPN: Bridge Support JSON</name>
                    <key>sevpn[bridge.support]</key>
                    <delay>30s</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. JSON.</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a9831a41102a4b018d65568ed30f8db9</uuid>
                    <name>Sevpn Cascade Stats error message</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[cascade.stats,error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Этот айтем собирает содержимое ключа 'error' в возвращаемом JSON мастер элемента данных.
В шатном режиме он равен пустой строке.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.error</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'error'</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[user.stats]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>3911c14842144d79a93dd08c15de76a7</uuid>
                            <expression>length(last(/Template SoftEtherVPN server passive v3.0/sevpn[cascade.stats,error]))&gt;0</expression>
                            <name>Ошибка при обработке запроса cascade_stats</name>
                            <priority>WARNING</priority>
                            <description>Текст ошибки:  {{ITEM.LASTVALUE}.regsub(&quot;(.*)&quot;, \1)}

Если текст отображается не полностью, то его можно увидеть в мастер элементе данных в поле 'error'.</description>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>2996f66316df4d4ab42d767c78c5bf49</uuid>
                    <name>SoftEtherVPN: Cascade stats JSON</name>
                    <key>sevpn[cascade.stats]</key>
                    <delay>30s</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Получает JSON в котором находится вся вомзожная статистика по пингам внутренних/внешних узлов.</description>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. JSON.</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a16d132cb6ee47fcb51896bea698bde7</uuid>
                    <name>Sevpn Get Ping error message</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[get.ping,error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Этот айтем собирает содержимое ключа 'error' в возвращаемом JSON мастер элемента данных.
В шатном режиме он равен пустой строке.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.error</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'error'</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[user.stats]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>6324fb6ad49d4c5aa60a446e02f4ec36</uuid>
                            <expression>length(last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,error]))&gt;0</expression>
                            <name>Ошибка при обработке запроса get_ping</name>
                            <priority>WARNING</priority>
                            <description>Текст ошибки:  {{ITEM.LASTVALUE}.regsub(&quot;(.*)&quot;, \1)}

Если текст отображается не полностью, то его можно увидеть в мастер элементе данных в поле 'error'.</description>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>1c22a1d3ad4548d5b604f1a8020f405e</uuid>
                    <name>SoftEtherVPN: Get ping JSON</name>
                    <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                    <delay>30s</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Получает JSON в котором находится вся вомзожная статистика по пингам внутренних/внешних узлов.</description>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. JSON.</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2aecfcd6a5414e8eaac2de82f84b3c16</uuid>
                    <name>Sevpn Hub Stats error message</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[hub.stats,error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Этот айтем собирает содержимое ключа 'error' в возвращаемом JSON мастер элемента данных.
В шатном режиме он равен пустой строке.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.error</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'error'</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[user.stats]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>543b947f1c8244709f9f3dee0ce8f967</uuid>
                            <expression>length(last(/Template SoftEtherVPN server passive v3.0/sevpn[hub.stats,error]))&gt;0</expression>
                            <name>Ошибка при обработке запроса hub_stats</name>
                            <priority>WARNING</priority>
                            <description>Текст ошибки:  {{ITEM.LASTVALUE}.regsub(&quot;(.*)&quot;, \1)}

Если текст отображается не полностью, то его можно увидеть в мастер элементе данных в поле 'error'.</description>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>78e0eb03ce554bf59f884a1ee0ca8db5</uuid>
                    <name>SoftEtherVPN: Hub stats JSON</name>
                    <key>sevpn[hub.stats]</key>
                    <delay>30s</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. JSON.</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>22c59bf505a94e05bb47c7c84095d844</uuid>
                    <name>Sevpn Listener Stats error message</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[listener.stats,error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Этот айтем собирает содержимое ключа 'error' в возвращаемом JSON мастер элемента данных.
В шатном режиме он равен пустой строке.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.error</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'error'</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[user.stats]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>65c2011ba4a2492f99cfd965fd2d1001</uuid>
                            <expression>length(last(/Template SoftEtherVPN server passive v3.0/sevpn[listener.stats,error]))&gt;0</expression>
                            <name>Ошибка при обработке запроса listener_stats</name>
                            <priority>WARNING</priority>
                            <description>Текст ошибки:  {{ITEM.LASTVALUE}.regsub(&quot;(.*)&quot;, \1)}

Если текст отображается не полностью, то его можно увидеть в мастер элементе данных в поле 'error'.</description>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>713857b5bd5e4831bcb0e9c2a021c7f7</uuid>
                    <name>SoftEtherVPN: Listener stats JSON</name>
                    <key>sevpn[listener.stats]</key>
                    <delay>30s</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. JSON.</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>999b461148734286b2f4eeba13f05333</uuid>
                    <name>Server Info Sevpn Version</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.info,se.version]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['ServerVersionString_str']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ff478f09f5bd4610929974b053294119</uuid>
                    <name>Server Info uptime</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.info,uptime]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>s</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['zabbix_uptime']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>ede215ac9deb432686bbc118d932a2a9</uuid>
                            <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[server.info,uptime])&lt;10m</expression>
                            <name>SeVPN has been restarted</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>04322d0618c44ccd836f142fe07ab004</uuid>
                    <name>Server Status: Broadcast traffic RX per second</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,broadcast.bytes.rx.ps]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <units>Bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Recv.BroadcastBytes_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3beb28c3a3f143b386433d50dd7c94d3</uuid>
                    <name>Server Status: Broadcast traffic RX</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,broadcast.bytes.rx]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Recv.BroadcastBytes_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4ed7fb44d3d6496c8bb1369b4a1cae5a</uuid>
                    <name>Server Status: Broadcast traffic TX per second</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,broadcast.bytes.tx.ps]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <units>Bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Send.BroadcastBytes_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3ef07ccf021b4ce886548c3a5cb8f333</uuid>
                    <name>Server Status: Broadcast traffic TX</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,broadcast.bytes.tx]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Send.BroadcastBytes_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e7e58c3278ea4416880ed6af8ec71b68</uuid>
                    <name>Server Status: Broadcast packets RX</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,broadcast.packets.rx]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Recv.BroadcastCount_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a3cc8beeefec4fd38a400c6f6062f7a9</uuid>
                    <name>Server Status: Broadcast packets TX</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,broadcast.packets.tx]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Send.BroadcastCount_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f0daa02e92474afcb60d73bede2c582b</uuid>
                    <name>Sevpn Server Status error message</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Этот айтем собирает содержимое ключа 'error' в возвращаемом JSON мастер элемента данных.
В шатном режиме он равен пустой строке.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.error</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'error'</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>5f785f2805ea4223a0b3b8c5be6e180f</uuid>
                            <expression>length(last(/Template SoftEtherVPN server passive v3.0/sevpn[server.status,error]))&gt;0</expression>
                            <name>Ошибка при обработке запроса server_status</name>
                            <priority>WARNING</priority>
                            <description>Текст ошибки:  {{ITEM.LASTVALUE}.regsub(&quot;(.*)&quot;, \1)}

Если текст отображается не полностью, то его можно увидеть в мастер элементе данных в поле 'error'.</description>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>ab396b486cdd488d8a9cfad8d299b30a</uuid>
                    <name>Server Status: Memory (free)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,memory.free]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['FreeMemory_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>24fa1a51c9844e8c84e65a9780827905</uuid>
                    <name>Server Status: Memory physical (free)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,memory.phys.free]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['FreePhys_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f1f417cc9c6e4974931c67d846125edd</uuid>
                    <name>Server Status: Memory physical (total)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,memory.phys.total]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['TotalPhys_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>21e62ac4051241d48d4280157bbf0a45</uuid>
                    <name>Server Status: Memory physical (used)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,memory.phys.used]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['UsedPhys_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>66ba28030ee3478fb4772351529a5069</uuid>
                    <name>Server Status: Memory (total)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,memory.total]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['TotalMemory_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>cc3682f3987241cb88be5b7e310dacc3</uuid>
                    <name>Server Status: Memory (used)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,memory.used]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['UsedMemory_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4cbf36b1607e488f8568748f6de90ee7</uuid>
                    <name>Server Status: Number of groups</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.groups]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumGroups_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e0790c21700942dfad23ff408f26e30a</uuid>
                    <name>Server Status: HUB number (dynamic)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.hub.num.dynamic]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumHubDynamic_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>82bf7d455e924ecd897b9ba4494d37a1</uuid>
                    <name>Server Status: HUB number (standalone)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.hub.num.standalone]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumHubStandalone_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1e12b564d85941c7969491ebd8cdeb5d</uuid>
                    <name>Server Status: HUB number (static)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.hub.num.static]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumHubStatic_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2f4380aec61b4ffd8d6b29392dd46255</uuid>
                    <name>Server Status: HUB number (total)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.hub.num.tot]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumHubTotal_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7b3c3253a4ed4b6a9b244ff3af6b32aa</uuid>
                    <name>Server Status: Number of IP tables</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.ip.tables]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumIpTables_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>00564df5ace842db80a3e4dd8c3c51f6</uuid>
                    <name>Server Status: Number of MAC tables</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.mac.tables]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumMacTables_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c3d1ee6392824b359f72fc2756430073</uuid>
                    <name>Server Status: Number of sessions (remote)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.sess.remote]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumSessionsRemote_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b336a64f0e0f4788a8b2be1593de0bd9</uuid>
                    <name>Server Status: Number of TCP connections (local)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.tcp.conn.loc]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumTcpConnectionsLocal_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>43f0298133244f5c82dadc986ddd1b6f</uuid>
                    <name>Server Status: Number of TCP connections (remote)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.tcp.conn.rem]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumTcpConnectionsRemote_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ed69f62a439143fa9a2468f6572629db</uuid>
                    <name>Server Status: Number of TCP connections (total)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.tcp.conn.tot]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumTcpConnections_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>39c1e90d8913408984f717b3ee455d15</uuid>
                    <name>Server Status: Number of sessions (local)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.tcp.sess.local]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumSessionsLocal_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>eaf9d258cd4d40f9b4e41c32faee23b5</uuid>
                    <name>Server Status: Number of sessions (total)</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.tcp.sess.total]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumSessionsTotal_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>54110df8016f4beca86437a110e973c3</uuid>
                    <name>Server Status: Number of users</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,num.users]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['NumUsers_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a85a63a514594783be6ad2075985230f</uuid>
                    <name>Server Status: server type</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,server.type]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['ServerType_u32']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c1ac95abba7840afa6b04a2fd5369530</uuid>
                    <name>Server Status: Unicast traffic RX per second</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,unicast.bytes.rx.ps]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <units>Bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Recv.UnicastBytes_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9bde03fbe74949e5b69da40792ce1496</uuid>
                    <name>Server Status: Unicast traffic RX</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,unicast.bytes.rx]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Recv.UnicastBytes_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>05d899dfa8a84cdfac047c6cf80933fe</uuid>
                    <name>Server Status: Unicast traffic TX per second</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,unicast.bytes.tx.ps]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <units>Bps</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Send.UnicastBytes_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9cc3695c58764572a8ffaa7af20ab08d</uuid>
                    <name>Server Status: Unicast traffic TX</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,unicast.bytes.tx]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Send.UnicastBytes_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f9b04ca91d9c46c5af19a6406dca3daf</uuid>
                    <name>Server Status: Unicast packets RX</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,unicast.packets.rx]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Recv.UnicastCount_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1696c395533d4d8fa1c43b5bd5272a1c</uuid>
                    <name>Server Status: Unicast packets TX</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[server.status,unicast.packets.tx]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.data</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$['result']['Send.UnicastCount_u64']</parameter>
                            </parameters>
                            <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[server.status]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>38007cdf538e4663b600ec87b4a41782</uuid>
                    <name>SoftEtherVPN: Server Status JSON</name>
                    <key>sevpn[server.status]</key>
                    <delay>30s</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. JSON.</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d092def10e2b479c8d94f2c2e4515ee9</uuid>
                    <name>Sevpn User Stats error message</name>
                    <type>DEPENDENT</type>
                    <key>sevpn[user.stats,error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Этот айтем собирает содержимое ключа 'error' в возвращаемом JSON мастер элемента данных.
В шатном режиме он равен пустой строке.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.error</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Не валидный JSON или отсутствует ключ 'error'</error_handler_params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sevpn[user.stats]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. General</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>8f812c28e8244ddf81dbd33b9bd1a0c3</uuid>
                            <expression>length(last(/Template SoftEtherVPN server passive v3.0/sevpn[user.stats,error]))&gt;0</expression>
                            <name>Ошибка при обработке запроса user_stats</name>
                            <priority>WARNING</priority>
                            <description>Текст ошибки:  {{ITEM.LASTVALUE}.regsub(&quot;(.*)&quot;, \1)}

Если текст отображается не полностью, то его можно увидеть в мастер элементе данных в поле 'error'.</description>
                            <dependencies>
                                <dependency>
                                    <name>vpn server stopped on {HOST.NAME}</name>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/proc.num[{$VPN_PROC_NAME}])&lt;2</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>d8510e4b1ba9409ab77216626877953d</uuid>
                    <name>SoftEtherVPN: User stats JSON</name>
                    <key>sevpn[user.stats]</key>
                    <delay>30s</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Sevpn. JSON.</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>9c5eb29711de4a6a927879a2b0b97a66</uuid>
                    <name>Sevpn: Bridge discovery</name>
                    <key>sevpn[bridge.discovery]</key>
                    <delay>10m</delay>
                    <lifetime>1d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>c829be7f16f74a85af1cf057f0b1cdf1</uuid>
                            <name>Bridge HUB[$2] DEV[$3] ISTAP[$4] active</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[bridge.stats,{#HUBNAME},{#IFNAME},{#TAPMODE},is.active]</key>
                            <delay>0</delay>
                            <description>Hub Name: &quot;{#HUBNAME}&quot;
If Name: &quot;{#IFNAME}&quot;
Is Active: &quot;{#ACTIVE}&quot;
Is Online: &quot;{#ONLINE}&quot;
Is Tap Mode: &quot;{#TAPMODE}&quot;</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#IFNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#TAPMODE}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Active_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[bridge.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 2.Bridges</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>97dccb21ceaa442587f955a1f37a46b6</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[bridge.stats,{#HUBNAME},{#IFNAME},{#TAPMODE},is.active])=0</expression>
                                    <name>Sevpn Bridge:  интерфейс {#IFNAME} в системе неактивен</name>
                                    <priority>HIGH</priority>
                                    <description>Данный интерфейс связан в мост с виртуальным хабом {#HUBNAME}
Если деактивация интерфейса не была запланирована, то это означает, что трафик не ходит. Нужно срочно зайти в настройки ОС и активировать интерфейс.

В противном случае возможно следует разобрать мост и/или добавить его в исключения правил обнаружения в мониторинге.

Критерии:
 - имя хаба #HUBNAME - {#HUBNAME}
 - имя устройства #IFNAME - {#IFNAME}</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Sevpn Bridge: мост выключен из-за того что VHUB {#HUBNAME} перестал быть online</name>
                                            <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[bridge.stats,{#HUBNAME},{#IFNAME},{#TAPMODE},is.online])=0</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>06dd97f922194b1a84bf252f523ed5aa</uuid>
                            <name>Bridge HUB[$2] DEV[$3] ISTAP[$4] online</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[bridge.stats,{#HUBNAME},{#IFNAME},{#TAPMODE},is.online]</key>
                            <delay>0</delay>
                            <description>Hub Name: &quot;{#HUBNAME}&quot;
If Name: &quot;{#IFNAME}&quot;
Is Active: &quot;{#ACTIVE}&quot;
Is Online: &quot;{#ONLINE}&quot;
Is Tap Mode: &quot;{#TAPMODE}&quot;</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#IFNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#TAPMODE}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Online_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[bridge.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 2.Bridges</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>b7c11f47e443489c81b30c4c1e71ca14</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[bridge.stats,{#HUBNAME},{#IFNAME},{#TAPMODE},is.online])=0</expression>
                                    <name>Sevpn Bridge: мост выключен из-за того что VHUB {#HUBNAME} перестал быть online</name>
                                    <priority>HIGH</priority>
                                    <description>Если это незапланированное действие, то нужно зайти в настройки сервера и включить виртуальный хаб {#HUBNAME}

В противном случае возможно нужно выключить данный триггер и/или добавить данный бридж в исключения в автообнаружении.

Критерии:
имя хаба #HUBNAME - {#HUBNAME}
имя устройства #IFNAME - {#IFNAME}</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>b42d108e50644260a31d33529cc28b00</uuid>
                    <name>Sevpn: Cascade discovery</name>
                    <key>sevpn[cascade.discovery]</key>
                    <delay>10m</delay>
                    <lifetime>1d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>f96c95d3584144a393cb430d36574084</uuid>
                            <name>Sevpn Cascade: {#HUBNAME}: {#CASCADENAME} connected</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[cascade.stats,{#HUBNAME},{#CASCADENAME},connected]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#CASCADENAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Connected_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[cascade.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:{#HUBNAME} 3.Cascade:[{#CASCADENAME}] Common</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>01da5c25b6c64b0781e9140592f9b405</uuid>
                            <name>Sevpn Cascade: {#HUBNAME}: {#CASCADENAME} last error</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[cascade.stats,{#HUBNAME},{#CASCADENAME},last.error]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#CASCADENAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['LastError_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[cascade.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:{#HUBNAME} 3.Cascade:[{#CASCADENAME}] Common</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1b5990fd03eb4e3cb9ea85f1c496ec1e</uuid>
                            <name>Sevpn Cascade: {#HUBNAME}: {#CASCADENAME} online</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[cascade.stats,{#HUBNAME},{#CASCADENAME},online]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#CASCADENAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Online_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[cascade.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:{#HUBNAME} 3.Cascade:[{#CASCADENAME}] Common</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>c736c9d7bfb14025baba5e9f32543e26</uuid>
                            <expression>(last(/Template SoftEtherVPN server passive v3.0/sevpn[cascade.stats,{#HUBNAME},{#CASCADENAME},connected])=0
and
last(/Template SoftEtherVPN server passive v3.0/sevpn[cascade.stats,{#HUBNAME},{#CASCADENAME},online])=1)
or
last(/Template SoftEtherVPN server passive v3.0/sevpn[cascade.stats,{#HUBNAME},{#CASCADENAME},last.error])&lt;&gt;0</expression>
                            <name>Каскад {#HUBNAME} {#CASCADENAME} не подключен</name>
                            <priority>HIGH</priority>
                            <description>Каскад не подключен.
Хаб: {#HUBNAME}
Имя каскада: {#CASCADENAME}
Целевой хаб: {#TARGETHUB}

Подключено: {ITEM.LASTVALUE1} ( 1 - вкл, 0 - выкл )
Онлайн (активирован): {ITEM.LASTVALUE2} ( 1 - онлайн, 0 - офлайн/выключен/деактивирован )
Код ошибки: {ITEM.LASTVALUE3} ( 0 - ok, 9 - проблемы с авторизацией, ... )</description>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>38614f6b985a4224b40040274a891e4e</uuid>
                    <name>Sevpn: Ping discovery - external</name>
                    <key>sevpn[external.ping.discovery]</key>
                    <delay>10m</delay>
                    <lifetime>1d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>0eb6cb294aeb4694bb3cfe3284837ac1</uuid>
                            <name>Sevpn: Ping {#HOSTNAME} avg</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},avg]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                            <description>Хост который пингуется: {#HOSTNAME}
Хаб источника: {#HUBNAME}
Хаб назначения: {#TARGETHUB}</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['external']</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ ['data']['external']</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HOSTNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['avg']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. External Pings &amp; loss</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>f9d2c4d41cde4cf49e24c8783d11405b</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},avg])&gt;{$SEVPN_EXT_PING_HIGH:&quot;{#HOSTNAME}&quot;}</expression>
                                    <name>Sevpn: Пинг до {#HOSTNAME} высокий</name>
                                    <priority>INFO</priority>
                                    <description>Значение порога пинга: {$SEVPN_EXT_PING_HIGH:&quot;{#HOSTNAME}&quot;} ms
Предполагается плохое качество связи между хабами {#HUBNAME} ({HOSTNAME}) и {#TARGETHUB} ({#HOSTNAME})</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Sevpn: Узел назначения {#HOSTNAME} недоступен</name>
                                            <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},loss])=100</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>e446fc1249b649c5861473d539b9809b</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},avg])&gt;{$SEVPN_EXT_PING_VERY_HIGH:&quot;{#HOSTNAME}&quot;}</expression>
                                    <name>Sevpn: Пинг до {#HOSTNAME} очень высокий</name>
                                    <priority>INFO</priority>
                                    <description>Значение порога пинга: {$SEVPN_EXT_PING_VERY_HIGH:&quot;{#HOSTNAME}&quot;} ms
Предполагается плохое качество связи между хабами {#HUBNAME} ({HOSTNAME}) и {#TARGETHUB} ({#HOSTNAME})</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Sevpn: Узел назначения {#HOSTNAME} недоступен</name>
                                            <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},loss])=100</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>5c5d083c2cdd4f028724f8f0ae328458</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},avg])&gt;{$SEVPN_EXT_PING_TOO_HIGH:&quot;{#HOSTNAME}&quot;}</expression>
                                    <name>Sevpn: Пинг до {#HOSTNAME} слишком высокий</name>
                                    <priority>INFO</priority>
                                    <description>Значение порога пинга: {$SEVPN_EXT_PING_TOO_HIGH:&quot;{#HOSTNAME}&quot;} ms
Предполагается плохое качество связи между хабами {#HUBNAME} ({HOSTNAME}) и {#TARGETHUB} ({#HOSTNAME})</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Sevpn: Узел назначения {#HOSTNAME} недоступен</name>
                                            <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},loss])=100</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>2fed3d67787b4f0aa5d52787fcbc8e12</uuid>
                            <name>Sevpn: Ping {#HOSTNAME} loss</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},loss]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>Хост который пингуется: {#HOSTNAME}
Хаб источника: {#HUBNAME}
Хаб назначения: {#TARGETHUB}</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['external']</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ ['data']['external']</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HOSTNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['loss']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. External Pings &amp; loss</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>99df6086d4ff48ad94b75e112f7dce05</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},loss])=100</expression>
                                    <name>Sevpn: Узел назначения {#HOSTNAME} недоступен</name>
                                    <priority>WARNING</priority>
                                    <description>Данный сервер подключается к {#HOSTNAME} для установления связи между хабами {#HUBNAME} (этот хост) и {#TARGETHUB} (удаленный хост).</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>5c00744b76b14f98b9fa2915b1626413</uuid>
                            <name>Sevpn: Ping {#HOSTNAME} max</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},max]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                            <description>Хост который пингуется: {#HOSTNAME}
Хаб источника: {#HUBNAME}
Хаб назначения: {#TARGETHUB}</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['external']</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ ['data']['external']</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HOSTNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['max']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. External Pings &amp; loss</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d709526d933545b6967a62f3d164de7f</uuid>
                            <name>Sevpn: Ping {#HOSTNAME} min</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},min]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                            <description>Хост который пингуется: {#HOSTNAME}
Хаб источника: {#HUBNAME}
Хаб назначения: {#TARGETHUB}</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['external']</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ ['data']['external']</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HOSTNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['min']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. External Pings &amp; loss</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>281d54589ec946b8a57ef2240c9a41bf</uuid>
                            <name>Sevpn: пинг до {#HOSTNAME}.   {#HUBNAME} &lt;-&gt; {#TARGETHUB}</name>
                            <graph_items>
                                <graph_item>
                                    <color>FFFF00</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},avg]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>DASHED_LINE</drawtype>
                                    <color>0040FF</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},max]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <drawtype>DOTTED_LINE</drawtype>
                                    <color>00FF00</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},min]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>FF0000</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#HOSTNAME},{#HUBNAME},{#TARGETHUB},loss]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>597220a5f02143b08fc163dd318bfdaf</uuid>
                    <name>Sevpn: Hub discovery</name>
                    <key>sevpn[hub.discovery]</key>
                    <delay>10m</delay>
                    <lifetime>1d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>f37327addc224ada9528240be211f2d3</uuid>
                            <name>Sevpn HUB: {#HUBNAME} ACL's count</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},acl.count]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumAccessLists_u32']</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d6de3af259e8409890f19f4a259a2c5f</uuid>
                            <name>Sevpn HUB: {#HUBNAME} broadcast traffic RX per second</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},broadcast.bytes.rx.ps]</key>
                            <delay>0</delay>
                            <units>Bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Recv.BroadcastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9f33d482b03348faaa162f1029a24990</uuid>
                            <name>Sevpn HUB: {#HUBNAME} broadcast traffic RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},broadcast.bytes.rx]</key>
                            <delay>0</delay>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Recv.BroadcastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>2678932260034cce9f68b313869abcdc</uuid>
                            <name>Sevpn HUB: {#HUBNAME} broadcast traffic TX per second</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},broadcast.bytes.tx.ps]</key>
                            <delay>0</delay>
                            <units>Bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Send.BroadcastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>01e284782a784a3381250ed41497c270</uuid>
                            <name>Sevpn HUB: {#HUBNAME} broadcast traffic TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},broadcast.bytes.tx]</key>
                            <delay>0</delay>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Send.BroadcastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>592752d142ab4036bc02af8340d33556</uuid>
                            <name>Sevpn HUB: {#HUBNAME} broadcast packets RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},broadcast.packets.rx]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Recv.BroadcastCount_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>8f0e193f8fa5479fbd7514a61c40568b</uuid>
                            <name>Sevpn HUB: {#HUBNAME} broadcast packets TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},broadcast.packets.tx]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Send.BroadcastCount_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e41061e3d18e41dca735a342b67ad620</uuid>
                            <name>Sevpn HUB: {#HUBNAME} groups count</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},groups.count]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumGroups_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>7729d4938d7d4f92905aac60b20da023</uuid>
                            <name>Sevpn HUB: {#HUBNAME} IP tables count</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},ip.tables.count]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumIpTables_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d651a566a5974a0db948b7f2dd4a29a1</uuid>
                            <name>Sevpn HUB: {#HUBNAME} number of new logins</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},logins.count.new]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumLogin_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>7f39a0d1c63b41838f746725e78ede7f</uuid>
                            <name>Sevpn HUB: {#HUBNAME} number of logins</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},logins.count]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumLogin_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>937eec0dabef490f875e9cf0c7060511</uuid>
                            <name>Sevpn HUB: {#HUBNAME} MAC tables count</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},mac.tables.count]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumMacTables_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>34ef7f616e824a15b8a1cfa4e710c466</uuid>
                            <name>Sevpn HUB: {#HUBNAME} SecureNAT enabled</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},securenat.enabled]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['SecureNATEnabled_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>042046be75074293b231c4461d49ddad</uuid>
                            <name>Sevpn HUB: {#HUBNAME} sessions count (bridge)</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},sessions.count.bridge]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumSessionsBridge_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>18dccbf3f35d4e518677e69f5a24cf73</uuid>
                            <name>Sevpn HUB: {#HUBNAME} sessions count (client)</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},sessions.count.client]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumSessionsClient_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d82c4b96d3de48f79a724289a8886217</uuid>
                            <name>Sevpn HUB: {#HUBNAME} sessions count</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},sessions.count]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumSessions_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c7eca5f30c2f463eb18ad11404659f7e</uuid>
                            <name>Sevpn HUB: {#HUBNAME} status</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},status]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Online_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>69b99290742f4815a31b016c6530f07f</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[hub.stats,{#HUBNAME},status])=0</expression>
                                    <name>Sevpn HUB: {#HUBNAME} находится в состоянии OFFLINE</name>
                                    <priority>AVERAGE</priority>
                                    <description>Данные с последнего автообнаружения:
ХАБ: {#HUBNAME}
Состояние: {#ONLINE} ( 0 - был оффлайн, 1 - был онлайн)
Текущее состояние: {ITEM.LASTVALUE1} ( 0 - оффлайн, 1 - онлайн )

Если через из хаба куда то вели каскады - все сейчас отключено и трафика нет.
Если к хабу подключались другие серверы (каскадами) и пользователи  - все сейчас отключено (должны гореть триггеры об отпавших каскадах).
Если хаб был включен в мост с интерфейсом, то он сейчас оффлайн (должен быть соответствующий триггер).

Если отключение хаба это результат плановых действий, то нужно деактивировать триггеры и/или включить виртуальный хаб в фильтр исключение в настройках мониторинга.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>5a81c8d7ce384e6fb9518b0825dfb0da</uuid>
                            <name>Sevpn HUB: {#HUBNAME} type</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},type]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['HubType_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c9a61ef0cc0a428a905f1bb3d5b7fabc</uuid>
                            <name>Sevpn HUB: {#HUBNAME} unicast traffic RX per second</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},unicast.bytes.rx.ps]</key>
                            <delay>0</delay>
                            <units>Bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Recv.UnicastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d8ec8f13289e43fbbadefee334b328db</uuid>
                            <name>Sevpn HUB: {#HUBNAME} unicast traffic RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},unicast.bytes.rx]</key>
                            <delay>0</delay>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Recv.UnicastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>dfc0cbcd2b5e4d829009ce54235c2beb</uuid>
                            <name>Sevpn HUB: {#HUBNAME} unicast traffic TX per second</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},unicast.bytes.tx.ps]</key>
                            <delay>0</delay>
                            <units>Bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Send.UnicastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b6b505911cd443dba2656bd4880602e5</uuid>
                            <name>Sevpn HUB: {#HUBNAME} unicast traffic TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},unicast.bytes.tx]</key>
                            <delay>0</delay>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Send.UnicastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9c9a1d8a888c4d1392ba443f4a653201</uuid>
                            <name>Sevpn HUB: {#HUBNAME} unicast packets RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},unicast.packets.rx]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Recv.UnicastCount_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>99f72b07169d4d02a4948495ac47bc61</uuid>
                            <name>Sevpn HUB: {#HUBNAME} unicast packets TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},unicast.packets.tx]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Send.UnicastCount_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>4703362f7a5440e19f6323b63c254867</uuid>
                            <name>Sevpn HUB: {#HUBNAME} users count</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},users.count]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NumUsers_u32']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>299185fc308f4c328e002b2865568f9f</uuid>
                            <name>Sevpn HUB: {#HUBNAME} visibility</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[hub.stats,{#HUBNAME},visibility]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['NoEnum_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[hub.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 1.General metrics</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>6e0f13d3afde47538e463de9bdad98af</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[hub.stats,{#HUBNAME},visibility])=0</expression>
                                    <name>Sevpn HUB: {#HUBNAME} видим для анонимных подключений</name>
                                    <priority>HIGH</priority>
                                    <description>Данные с последнего автообнаружения:
ХАБ: {#HUBNAME}
Состояние: {#ONLINE} ( 0 - был оффлайн, 1 - был онлайн)
Текущее состояние: {ITEM.LASTVALUE1} ( 0 - видим, 1 - невидим )

Данный триггер свидетельствует о потенциальной угрозе безопасности.
Любой анонимный пользователь при подключении к данному серверу может видеть в списке доступных хабов текущий. Это позволит упростить процедуру взлома путем перебора.

Требуется оценить степень опасности данного фактора.
В случае подтверждения потенциальной угрозы следует установить флажок &quot;No Enymerate to Anonymous Users&quot; в свойствах виртуального хаба.
В случае если потенциальная угроза не страшна данный триггер можно отключить.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>dd6b4daa1b634a409c1e7fe89bd31785</uuid>
                            <name>Sevpn HUB: {#HUBNAME} broadcast traffic</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>00FF00</color>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},broadcast.bytes.rx.ps]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>0080FF</color>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},broadcast.bytes.tx.ps]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <uuid>84ae4538d6d641c296572bdb2facc220</uuid>
                            <name>Sevpn HUB: {#HUBNAME} general stats</name>
                            <graph_items>
                                <graph_item>
                                    <color>0080FF</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},acl.count]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>FFBF00</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},groups.count]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>BF00FF</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},ip.tables.count]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>43A047</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},mac.tables.count]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>6D4C41</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},users.count]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <uuid>6e8e86cfa05045288a3dc86dd9b0496e</uuid>
                            <name>Sevpn HUB: {#HUBNAME} logins, NAT</name>
                            <graph_items>
                                <graph_item>
                                    <color>00FF00</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},logins.count.new]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>4000FF</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},securenat.enabled]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <uuid>fc0a1198f4c44d00a5e6ee7a183d3d71</uuid>
                            <name>Sevpn HUB: {#HUBNAME} sessions</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>FF0000</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},sessions.count]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>FFFF00</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},sessions.count.bridge]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>0080FF</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},sessions.count.client]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <uuid>d96583a22a7045219d60a1275cca0922</uuid>
                            <name>Sevpn HUB: {#HUBNAME} unicast traffic</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>00FF00</color>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},unicast.bytes.rx.ps]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>0080FF</color>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[hub.stats,{#HUBNAME},unicast.bytes.tx.ps]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>7c28221979ca40f496e1c536feac6341</uuid>
                    <name>Sevpn: Ping discovery - internal</name>
                    <key>sevpn[internal.ping.discovery]</key>
                    <delay>10m</delay>
                    <lifetime>1d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>ef25e632d6f647bdbb5c052878bb0de6</uuid>
                            <name>Sevpn: Ping {#TARGET_HOST} {#TARGETHUB} avg</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},avg]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['internal']</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ ['data']['internal']</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#TARGET_HOST}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['avg']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 3.Cascade:[{#ACCOUNT_NAME}:{#TARGET_HOST}] Pings &amp; loss</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>491f86a016e84132a4306ab23dbaeabf</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},avg])&gt;{$SEVPN_INT_PING_HIGH:&quot;{#TARGET_HOST}&quot;}</expression>
                                    <name>Sevpn: Пинг до {#TARGET_HOST} ({#TARGETHUB}) высокий</name>
                                    <priority>INFO</priority>
                                    <description>Значение порога пинга: {$SEVPN_INT_PING_HIGH:&quot;{#TARGET_HOST}&quot;} ms

Между хабом {#HUBNAME} на данном сервере и хабом {#TARGETHUB} на сервере {#HOSTNAME} высокое значение пинга внутри каскада: {ITEM.LASTVALUE1} ms</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Sevpn: Узел назначения {#TARGET_HOST} недоступен внутри каскада {#ACCOUNT_NAME}</name>
                                            <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},loss])=100</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>10b097b3b33e4049885581d810c3afcd</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},avg])&gt;{$SEVPN_INT_PING_VERY_HIGH:&quot;{#TARGET_HOST}&quot;}</expression>
                                    <name>Sevpn: Пинг до {#TARGET_HOST} ({#TARGETHUB}) очень высокий</name>
                                    <priority>INFO</priority>
                                    <description>Значение порога пинга: {$SEVPN_INT_PING_TOO_HIGH:&quot;{#TARGET_HOST}&quot;} ms

Между хабом {#HUBNAME} на данном сервере и хабом {#TARGETHUB} на сервере {#HOSTNAME} высокое значение пинга внутри каскада: {ITEM.LASTVALUE1} ms</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Sevpn: Узел назначения {#TARGET_HOST} недоступен внутри каскада {#ACCOUNT_NAME}</name>
                                            <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},loss])=100</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>6c22c1fcbdb94cb28f245c6850fabeb6</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},avg])&gt;{$SEVPN_INT_PING_TOO_HIGH:&quot;{#TARGET_HOST}&quot;}</expression>
                                    <name>Sevpn: Пинг до {#TARGET_HOST} ({#TARGETHUB}) слишком высокий</name>
                                    <priority>INFO</priority>
                                    <description>Значение порога пинга: {$SEVPN_INT_PING_TOO_HIGH:&quot;{#TARGET_HOST}&quot;} ms

Между хабом {#HUBNAME} на данном сервере и хабом {#TARGETHUB} на сервере {#HOSTNAME} высокое значение пинга внутри каскада: {ITEM.LASTVALUE1} ms</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Sevpn: Узел назначения {#TARGET_HOST} недоступен внутри каскада {#ACCOUNT_NAME}</name>
                                            <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},loss])=100</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0e76a7bffe8c474594d4eb21ae96afb0</uuid>
                            <name>Sevpn: Ping {#TARGET_HOST} {#TARGETHUB} loss</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},loss]</key>
                            <delay>0</delay>
                            <units>%</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['internal']</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ ['data']['internal']</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#TARGET_HOST}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['loss']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 3.Cascade:[{#ACCOUNT_NAME}:{#TARGET_HOST}] Pings &amp; loss</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>fd085d5f70e3462d92abfde0d32dfce4</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},loss])=100</expression>
                                    <name>Sevpn: Узел назначения {#TARGET_HOST} недоступен внутри каскада {#ACCOUNT_NAME}</name>
                                    <priority>WARNING</priority>
                                    <description>Куда ведет каскад.
Внешний узле подключения: {#HOSTNAME}
Каскад находится в хабе: {#HUBNAME}
Каскад подключается в хаб: {#TARGETHUB}
Адрес назначения: {#TARGET_HOST}
Имя каскада: {#ACCOUNT_NAME}:{#TARGET_HOST}</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b7edb94c481d4475a3b40da48e0ae87c</uuid>
                            <name>Sevpn: Ping {#TARGET_HOST} {#TARGETHUB} max</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},max]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['internal']</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ ['data']['internal']</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#TARGET_HOST}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['max']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 3.Cascade:[{#ACCOUNT_NAME}:{#TARGET_HOST}] Pings &amp; loss</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ce7485ff543e441cacc9bd9b1a703d16</uuid>
                            <name>Sevpn: Ping {#TARGET_HOST} {#TARGETHUB} min</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},min]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['internal']</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ ['data']['internal']</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#TARGET_HOST}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['min']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[get.ping,{$SEVPN_PING_COUNT}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 3.Cascade:[{#ACCOUNT_NAME}:{#TARGET_HOST}] Pings &amp; loss</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>ef1cf6909a2c4db0a5f2025953824496</uuid>
                            <name>Sevpn: пинг до {#TARGET_HOST}.   {#HUBNAME} &lt;-&gt; {#TARGETHUB} cascade: {#ACCOUNT_NAME}</name>
                            <graph_items>
                                <graph_item>
                                    <color>FFFF00</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},avg]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>F63100</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},loss]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <drawtype>DASHED_LINE</drawtype>
                                    <color>0040FF</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},max]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <drawtype>DOTTED_LINE</drawtype>
                                    <color>00FF00</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[get.ping,{$SEVPN_PING_COUNT},{#ACCOUNT_NAME},{#TARGET_HOST},{#TARGETHUB},{#HUBNAME},min]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>e12ce4ce669b470ca5750baff5be4abb</uuid>
                    <name>Sevpn: LIstener discovery</name>
                    <key>sevpn[listener.discovery]</key>
                    <delay>10m</delay>
                    <lifetime>1d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>674d82282614432991cd6f0cad2a64f9</uuid>
                            <name>Server Listener {#PORT} is enabled</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[listener.stats,{#PORT},is.enabled]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#PORT}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Enables_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[listener.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. Listeners</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>b309c597bee14c839ea2a3a7d4b94c0a</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[listener.stats,{#PORT},is.enabled])&lt;&gt;1</expression>
                                    <name>Sevpn Listener: порт {#PORT} деактивирован</name>
                                    <priority>WARNING</priority>
                                    <description>Порт {#PORT} переведен в стояние &quot;Остановлен/Деактивирован/Stop&quot;.

Если данный порт использовался для подключения внешних клиентов (каскады), то они сейчас испытывают проблемы с подключением.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>23ca4090d36e42a99ae2090e49072efe</uuid>
                            <name>Server Listener {#PORT} error state</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[listener.stats,{#PORT},is.error]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Не валидный JSON или отсутствует ключ 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#PORT}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Errors_bool']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[listener.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. Listeners</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>a367ef4427774e30bbd0e1cec4584848</uuid>
                                    <expression>last(/Template SoftEtherVPN server passive v3.0/sevpn[listener.stats,{#PORT},is.error])&lt;&gt;0</expression>
                                    <name>Sevpn Listener: ошибки на порту {#PORT}</name>
                                    <priority>HIGH</priority>
                                    <description>На порту {#PORT} возникли ошибки.
Возможно порт кто то занял. Если данный порт использовался для подключения внешних клиентов (каскады), то они сейчас испытывают проблемы с подключением.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>8c0de8082a684efda5eefc4cb7c2ede9</uuid>
                    <name>Sevpn: User discovery</name>
                    <key>sevpn[user.discovery]</key>
                    <delay>10m</delay>
                    <lifetime>1d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>728c1528492942ca930f56632235a5fb</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} broadcast traffic per second RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},broadcast.bytes.rx.ps]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Recv.BroadcastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e0dd8409a606455b89c2237531f5eef7</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} broadcast traffic RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},broadcast.bytes.rx]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Recv.BroadcastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>43f936d09dea49ba93643fa0ffaa8fb8</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} broadcast traffic per second TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},broadcast.bytes.tx.ps]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Send.BroadcastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e15dc7094a574d0da8fdde19d452e2e9</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} broadcast traffic TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},broadcast.bytes.tx]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Send.BroadcastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0628a6f146e845e390f4d46a38edd920</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} broadcast packets RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},broadcast.packets.rx]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Recv.UnicastCount_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a2251b83ea324b0f9a93f795db3cc487</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} broadcast packets TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},broadcast.packets.tx]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Send.BroadcastCount_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9e095ed7df89404493b63ebe394279f0</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} last login</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},last.login]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['LastLoginTime_dt']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>cdd9661c940548ee9c3e505088935342</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} unicast traffic per second RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},unicast.bytes.rx.ps]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Recv.UnicastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0413eff9013242b2b5a7429d67ea6f15</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} unicast traffic RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},unicast.bytes.rx]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Recv.UnicastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>317ad8dea4c5459ca3db08cc2f08181f</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} unicast traffic per second TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},unicast.bytes.tx.ps]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Send.UnicastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9eb4c25f1ed84a7e8920032e07b1fc15</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} unicast traffic TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},unicast.bytes.tx]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Send.UnicastBytes_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>da38b4d8791649a886d44fd37d3545c1</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} unicast packets RX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},unicast.packets.rx]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Recv.UnicastCount_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9ccaf798016b4471980503af93aa5702</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} unicast packets TX</name>
                            <type>DEPENDENT</type>
                            <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},unicast.packets.tx]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Мастер элемент данных не является валидным JSON или в нем нет ключа 'data'</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#HUBNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['{#USERNAME}']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$['Ex.Send.UnicastCount_u64']</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>sevpn[user.stats]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Sevpn. HUB:[{#HUBNAME}] 4.Users. [{#USERNAME}]</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>69a0c0c60fba493f8c1add39680745b5</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} broadcast traffic speed</name>
                            <graph_items>
                                <graph_item>
                                    <color>00FF00</color>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},broadcast.bytes.rx.ps]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0040FF</color>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},broadcast.bytes.tx.ps]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <uuid>aa5b19f50f8748269fcbc302c03b7092</uuid>
                            <name>Sevpn user: {#USERNAME}@{#HUBNAME} unicast traffic speed</name>
                            <graph_items>
                                <graph_item>
                                    <color>00FF00</color>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},unicast.bytes.rx.ps]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0040FF</color>
                                    <item>
                                        <host>Template SoftEtherVPN server passive v3.0</host>
                                        <key>sevpn[user.stats,{#HUBNAME},{#USERNAME},unicast.bytes.tx.ps]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$SEVPN_EXT_LOSS_HIGH}</macro>
                    <value>10</value>
                    <description>процент потерь пакетов который будет считаться достаточно выхоким, чтобы отобразить алерт. Значение по-умолчанию - 10 (%)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_EXT_LOSS_TOO_HIGH}</macro>
                    <value>40</value>
                    <description>следующий уровень эскалации по потерям пакетам. Значение по-умолчанию - 20 (%)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_EXT_LOSS_VERY_HIGH}</macro>
                    <value>20</value>
                    <description>максимальный уровень эскалации по потерям пакетов. Значение по-умолчанию - 40 (%)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_EXT_PING_HIGH}</macro>
                    <value>150</value>
                    <description>начальный уровень эскалации. Когда пинг превышает допустимый порог. По-умолчанию: 150</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_EXT_PING_TOO_HIGH}</macro>
                    <value>1500</value>
                    <description>максимальный уровень эскалации. По-умолчанию: 1500 (ms)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_EXT_PING_VERY_HIGH}</macro>
                    <value>500</value>
                    <description>следующий уровень эскалации. По-умолчанию: 500 (ms)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_INT_LOSS_HIGH}</macro>
                    <value>10</value>
                    <description>процент потерь пакетов который будет считаться достаточно выхоким, чтобы отобразить алерт. Значение по-умолчанию - 10 (%)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_INT_LOSS_TOO_HIGH}</macro>
                    <value>40</value>
                    <description>максимальный уровень эскалации по потерям пакетов. Значение по-умолчанию - 40 (%)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_INT_LOSS_VERY_HIGH}</macro>
                    <value>20</value>
                    <description>следующий уровень эскалации по потерям пакетам. Значение по-умолчанию - 20 (%)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_INT_PING_HIGH}</macro>
                    <value>150</value>
                    <description>начальный уровень эскалации. Когда пинг превышает допустимый порог. По-умолчанию: 150 (ms)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_INT_PING_TOO_HIGH}</macro>
                    <value>1500</value>
                    <description>максимальный уровень эскалации. По-умолчанию: 1500 (ms)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_INT_PING_VERY_HIGH}</macro>
                    <value>500</value>
                    <description>следующий уровень эскалации. По-умолчанию: 500 (ms)</description>
                </macro>
                <macro>
                    <macro>{$SEVPN_PING_COUNT}</macro>
                    <value>10</value>
                    <description>каким количеством пакетов будет осуществлена проверка канала. По-умолчанию: 10 (пакетов)</description>
                </macro>
                <macro>
                    <macro>{$VERSION}</macro>
                    <value>Version 4.18 Build 9570   (English)</value>
                    <description>по задумке должен был использоваться для опредления места где SEVPN остался не обновленным.</description>
                </macro>
                <macro>
                    <macro>{$VPN_PROC_NAME}</macro>
                    <value>vpnserver</value>
                    <description>имя процесса sevpn в системе (участвует в подсчете необходимого количества запущенных процессов в системе Linux. Привязан триггер.)</description>
                </macro>
            </macros>
        </template>
    </templates>
    <graphs>
        <graph>
            <uuid>027153c6fe214fa697917847d54d4762</uuid>
            <name>Sevpn Server: Broadcast traffic</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,broadcast.bytes.rx.ps]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>0040FF</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,broadcast.bytes.tx.ps]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>915211954e5e4391b1cb9a231ff75788</uuid>
            <name>Sevpn Server: groups, IPs, MACs</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.groups]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.ip.tables]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>2774A4</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.mac.tables]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>c335951aec594d4d9eae363496572277</uuid>
            <name>Sevpn Server: HUB common</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>FFFF00</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.hub.num.dynamic]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>0040FF</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.hub.num.standalone]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>00FF00</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.hub.num.static]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>FF0000</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.hub.num.tot]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>4e596dfa5519455ea74b5fcc5d3735f4</uuid>
            <name>Sevpn Server: memory</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,memory.free]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,memory.total]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>FFFF00</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,memory.used]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>bc2d7fc7b0a74688831cb8f2e6be4c03</uuid>
            <name>Sevpn Server: memory physical</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,memory.phys.free]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,memory.phys.total]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>FFFF00</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,memory.phys.used]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>ec3b46ded00c41a3bb3ac7ac7f61b0d1</uuid>
            <name>Sevpn Server: sessions</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.tcp.sess.local]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>FFFF00</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.sess.remote]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>FF0000</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.tcp.sess.total]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>9a63e77855894ca3a009fc679d32f3dd</uuid>
            <name>Sevpn Server: TCP connections</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.tcp.conn.loc]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.tcp.conn.rem]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>2774A4</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.tcp.conn.tot]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>c95f68122ecb4bbc896f64813785c1d6</uuid>
            <name>Sevpn Server: Unicast traffic</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,unicast.bytes.rx.ps]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>0040FF</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,unicast.bytes.tx.ps]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>aaa2cd2c28d449ee9f64f532afe2fd1e</uuid>
            <name>Sevpn Server: users</name>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>00FFFF</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template SoftEtherVPN server passive v3.0</host>
                        <key>sevpn[server.status,num.users]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
